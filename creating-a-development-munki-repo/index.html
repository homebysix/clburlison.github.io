<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Creating a development munki_repo  &middot; clburlison</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="Use vagrant along with virtualbox to create a fully functional munki_repo for testing on your localhost." />

<meta name="keywords" content="munki,, vagrant,, development,, testing,, munki_repo,, ">


<meta property="og:title" content="Creating a development munki_repo  &middot; clburlison ">
<meta property="og:site_name" content="clburlison"/>
<meta property="og:url" content="https://clburlison.com/creating-a-development-munki-repo/" />
<meta property="og:locale" content="en-EN">


<meta property="og:type" content="article" />
<meta property="og:description" content="Use vagrant along with virtualbox to create a fully functional munki_repo for testing on your localhost."/>
<meta property="og:article:published_time" content="2014-05-17T00:00:00Z" />
<meta property="og:article:modified_time" content="2014-05-17T00:00:00Z" />

  
    
<meta property="og:article:tag" content="munki,">
    
<meta property="og:article:tag" content="vagrant,">
    
<meta property="og:article:tag" content="development,">
    
<meta property="og:article:tag" content="testing,">
    
<meta property="og:article:tag" content="munki_repo,">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@clburlison" />
<meta name="twitter:creator" content="@clburlison" />
<meta name="twitter:title" content="Creating a development munki_repo" />
<meta name="twitter:description" content="Use vagrant along with virtualbox to create a fully functional munki_repo for testing on your localhost." />
<meta name="twitter:url" content="https://clburlison.com/creating-a-development-munki-repo/" />
<meta name="twitter:domain" content="https://clburlison.com/">
  

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "Creating a development munki_repo",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2014-05-17",
    "description": "Use vagrant along with virtualbox to create a fully functional munki_repo for testing on your localhost.",
    "wordCount": 982
  }
</script>



<link rel="canonical" href="https://clburlison.com/creating-a-development-munki-repo/" />

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://clburlison.com/touch-icon-144-precomposed.png">
<link href="https://clburlison.com/favicon.png" rel="icon">

<meta name="generator" content="Hugo 0.20" />

  
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link href='https://fonts.googleapis.com/css?family=Merriweather:300%7CRaleway%7COpen+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="https://clburlison.com/css/font-awesome.min.css">
<link rel="stylesheet" href="https://clburlison.com/css/style.css">
<link rel="stylesheet" href="https://clburlison.com/css/highlight/default.css">

  
  
	<script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-49614309-2', 'auto');
	  ga('send', 'pageview');

	</script>

</head>
<body>
  <main id="main-wrapper" class="container main_wrapper has-sidebar">
    <header id="main-header" class="container main_header">
  <div class="container brand">
  <div class="container title h1-like">
  <a class="baselink" href="https://clburlison.com/">
  clburlison

</a>

</div>

  
<div class="container topline">
  
  A Mac sysadmin, documenting useful code, ideas, &amp; guides.


</div>


</div>

  <nav class="container nav primary no-print">
  

<a class="homelink" href="https://clburlison.com/">Home</a>


  
<a href="https://clburlison.com/about">About</a>

<a href="https://clburlison.com/post" title="Show list of posts">Posts</a>

<a href="https://clburlison.com/resources">Resources</a>

<a href="https://clburlison.com/tags" title="Show list of tags">Tags</a>

<a href="https://clburlison.com/talks">Talks</a>


</nav>

<div class="container nav secondary no-print">
  
<a id="contact-link-email" class="contact_link" href="mailto:clburlison@gmail.com">
  <span class="fa fa-envelope-square"></span><span>email</span></a>



<a id="contact-link-github" class="contact_link" href="https://github.com/clburlison">
  <span class="fa fa-github-square"></span><span>github</span></a>





<a id="contact-link-linkedin" class="contact_link" href="https://www.linkedin.com/in/clburlison">
  <span class="fa fa-linkedin-square"></span><span>linkedin</span></a>







<a id="contact-link-twitter" class="contact_link" href="https://twitter.com/clburlison">
  <span class="fa fa-twitter-square"></span><span>twitter</span></a>













</div>


  

</header>


<article id="main-content" class="container main_content single">
  <header class="container hat">
  <h1>Creating a development munki_repo
</h1>

  <div class="metas">
<time datetime="2014-05-17">May 17, 2014</time>


  
  &middot; Read in about 5 min
  &middot; (982 Words)
  <br>
  
<a class="label" href="https://clburlison.com/tags/munki">munki</a>



</div>

</header>

  

<nav class="toc">
<input id="ac-toc" name="accordion-toc" type="checkbox">
<label for="ac-toc">Table of Contents</label>
<div id="toc" class="toc__menu">
<nav id="TableOfContents">
<ul>
<li><a href="#purpose">Purpose</a></li>
<li><a href="#required-software">Required software</a>
<ul>
<li><a href="#software-prerequisites-for-munki-dev">Software prerequisites for munki.dev</a>
<ul>
<li><a href="#vagrant">Vagrant</a></li>
<li><a href="#virtualbox">Virtualbox</a></li>
<li><a href="#git">Git</a></li>
<li><a href="#munkitools">Munkitools</a></li>
</ul></li>
</ul></li>
<li><a href="#installation">Installation</a>
<ul>
<li><a href="#adding-the-hostname">Adding the hostname</a></li>
<li><a href="#munki-repo-modifications">munki_repo Modifications</a></li>
</ul></li>
<li><a href="#client-settings">Client Settings</a></li>
<li><a href="#ending-notes">Ending notes</a></li>
</ul>
</nav>
</div>
</input>
</nav>



  <div class="container content">
  

<div class="alert alert-danger">
  <p><strong>Outdated:</strong> These instructions are no longer current and are considered deprecated. This document remains for historical reasons only. Faster and easier methods exist for creating development environments.</p>

</div>


<p>I created a vagrant box that allows you create a completely self contained munki_repo for testing purposes. With the usage of <a href="https://puphpet.com" target="_blank">PuPHPet</a> the process was quite easy.</p>

<p>This article describes basic usage and setup for the project <strong>munki.dev</strong>.</p>

<hr />

<h1 id="purpose">Purpose</h1>

<p>Setting up and maintaining a web server can be a pretty complex job. Apache is great at actually serving files but the initial setup can be tedious. Thanks to the many resources that are available on the internet this can become less tedious. Which brings me to the true purpose of the post&hellip;a way to setup a web server so I can test software patches using Munki.</p>

<p>In case you are unaware, Munki is a popular way to manage software installs on Mac OSX created by Greg Neagle. Learning Munki can be a time consuming process due to the many layers of the management system. One of the more important layers is the munki_repo, which is what this project is dedicated at helping with. This will allow you to setup a development environment which is self-contained on your administrative machine. Once the initial setup has been made you will be able to test changes locally without the need for a second machine.<br />
<em>Disclaimer</em>: this vagrant box is not designed for usage in production.</p>

<h1 id="required-software">Required software</h1>

<p>To use this project you will need to make sure you have the following software installed on your machine. All of these products can be obtained for free from the links provided. Below the prerequisites, each of the individual pieces of software have a short description explaining what they do. If you have some or any experience with the software needed for this you will likely want to skip past to the <a href="./#installation">Installation</a>.</p>

<h2 id="software-prerequisites-for-munki-dev">Software prerequisites for munki.dev</h2>

<ul>
<li>Vagrant  <a href="http://www.vagrantup.com" target="_blank">http://www.vagrantup.com</a></li>
<li>VirtualBox  <a href="https://www.virtualbox.org" target="_blank">https://www.virtualbox.org</a></li>
<li>Git  <a href="http://sourceforge.net/projects/git-osx-installer/" target="_blank">http://sourceforge.net/projects/git-osx-installer/</a></li>
<li>Munkitools <a href="https://github.com/munki/munki/releases" target="_blank">https://github.com/munki/munki/releases</a><br /></li>
</ul>

<h3 id="vagrant">Vagrant</h3>

<p>This is the backbone of this project. Vagrant&rsquo;s job is to interface directly with Virtualbox to create the virtual machine, download a ubuntu box, configure the box with puppet (plus other magic), and finally make any final changes needed for the munki.dev environment to work as intended. If this is the first project that are using Vagrant let me go ahead and say do not freak out. You do not actually have to know how to use Vagrant to take advantage of this project.</p>

<h3 id="virtualbox">Virtualbox</h3>

<p>A virtualization product created by Oracle that is free to use. At the time of this writing, I am using version 4.3.8, though munki.dev and Vagrant should not have issues with other versions so long as no incompatibilities arise from future releases of the software.</p>

<h3 id="git">Git</h3>

<p>Git is a way to store files and the changes that go along with those files in a logical manner. For this project, Git is the tool that will be used to download munki.dev and potentially a test munki_repo from from GitHub.
If you would like to learn more, I recommend reading this <a href="http://git-scm.com/book/en/Getting-Started-Git-Basics" target="_blank">Git Basics</a> page.</p>

<h3 id="munkitools">Munkitools</h3>

<p>This is the client software needed for Munki to work on Macintosh Clients created by Greg Neagle. This technically is not a requirement for the administrative machine but will make your life easier when making changes to the munki_repo. For that reason alone it is strongly recommended. Any clients that you wish to connect to this local webshare will require munkitools to be installed.</p>

<h1 id="installation">Installation</h1>

<p>Installing is quite straight forward once you have the required software. Simply issue the following commands in Terminal. You will want to <code>cd</code> to a directory of your choosing. I will pick <code>~/src/mine</code>. This will download the project from github.</p>

<pre><code class="language-bash">mkdir -p ~/src/mine/
cd ~/src/mine/
git clone https://github.com/clburlison/munki.dev.git munki.dev
cd munki.dev
</code></pre>

<p>This will pull down all the necessary files from Github.</p>

<h2 id="adding-the-hostname">Adding the hostname</h2>

<p>One change you will want to make is adding munki.dev to your <code>/etc/hosts</code> file. This allows you to connect to the web share as munki.dev instead of the IP address (default 192.168.56.150).</p>

<pre><code class="language-bash">sudo nano /etc/hosts
</code></pre>

<p>Add the following line to the bottom of your file.</p>

<pre><code class="language-bash">192.168.56.150  munki.dev
</code></pre>

<p>Save with Control + X.</p>

<p><strong>Note</strong>: at this current time there a known bug that prevents usage of the hostname from working when using an alias folder, aka Option 2 of the <code>bootstrap.sh</code>. Until this is fixed, please use the IP address for testing purposes instead of the hostname. Follow the issue <a href="https://github.com/clburlison/munki.dev/issues/1" target="_blank">here</a>.</p>

<h2 id="munki-repo-modifications">munki_repo Modifications</h2>

<p>Make these changes in the <code>bootstrap.sh</code> file.</p>

<p>You can point this virtual machine to a munki_repo that exists on your local admin machine. This means theoretically you could have a complete copy of your production munki_repo on your localhost or an external hard drive. This would allow you to point to that folder and start testing/development immediately.</p>

<p>This will default to downloading a the testing munki_repo since this will allow new users to get started with the least amount of work. To get the virtual machine started run the following command.</p>

<pre><code class="language-bash">./bootstrap
</code></pre>

<h1 id="client-settings">Client Settings</h1>

<p>At this point, the munki_repo should be up and running. You will want to setup a client computer to connect to the munki_repo. To do this you will need to run the following command on a client computer.</p>

<pre><code class="language-bash">sudo defaults write /Library/Preferences/ManagedInstalls SoftwareRepoURL &quot;http://192.168.56.150/munki_repo&quot;
sudo defaults write /Library/Preferences/ManagedInstalls ClientIdentifier testing
</code></pre>

<p>Now you should ready to test away. Open up <code>/Applications/Managed Software Center.app</code> if you are testing Munkitools v2 or <code>/Applications/Utilities/Managed Software Update.app</code> if you are testing Munkitools v1.</p>

<h1 id="ending-notes">Ending notes</h1>

<p>If you have any problems please create an <a href="https://github.com/clburlison/munki.dev/issues" target="_blank">Issue</a> on Github. Let me know what you think on Twitter, Email, etc.</p>

<p>Also, go check out <a href="https://github.com/hjuutilainen/munkiadmin" target="_blank">MunkiAdmin</a> for a GUI to modify your munki_repo. Another great resource is <a href="https://github.com/wollardj/Mandrill" target="_blank">Mandrill</a>, a web front end for managing you munki_repo. Lastly, check out the <a href="https://github.com/munki/munki/wiki" target="_blank">Getting Started with Munki</a> guide if you have any questions about munki.</p>

</div>


  <footer class="container">
  <div class="container navigation no-print">
  <h2>Navigation</h2>
  
  

    
    <a class="prev" href="https://clburlison.com/github-two-factor-authentication/" title="Github Two-factor Authentication with SourceTree">
      Previous
    </a>
    

    
    <a class="next" href="https://clburlison.com/find-my-mac/" title="Find My Mac">
      Next
    </a>
    

  


</div>

  <div class="container comments">
  <h2>Comments</h2>
  
<div id="disqus_thread"></div>
<script type="text/javascript">
  (function() {
    
    
    if (window.location.hostname == "localhost")
      return;

    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//clburlison.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>

</footer>

</article>
      <footer id="main-footer" class="container main_footer">
  

  <div class="container nav foot no-print">
  

  <a class="toplink" href="#">back to top</a>

</div>

  <div class="container credits">
  
<div class="container footline">
  
  powered by <a href="https://gohugo.io/" target="_blank">Hugo</a>.


</div>


  
<div class="container copyright">
  
  &copy; 2014 - 2017 Clayton Burlison


</div>


</div>

</footer>

    </main>
    
<script type="text/javascript">
  (function() {
    
    
    if (window.location.hostname == "localhost")
      return;

    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//clburlison.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



<script src="https://clburlison.com/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


    
  </body>
</html>

